-- 풀이
-- 대여 시작일이 2022년 9월
-- 대여 기간이 30일 이상이면 '장기 대여', 그렇지 않으면 '단기 대여' 로 표시하는 컬럼 추가
-- 대여 기록 출력하는 sql 문 작성하기
-- 결과는 대여 기록 id 를 기준으로 내림차순 정렬
select history_id, car_id, date_format(start_date, '%Y-%m-%d') start_date, date_format(end_date, '%Y-%m-%d') end_date, 
case
    when timestampdiff(DAY, start_date, end_date) >= 29 then '장기 대여'
    else '단기 대여'
end as 'rent_type'
from car_rental_company_rental_history
where start_date like '2022-09%'
order by 1 desc

/*
HISTORY_ID  CAR_ID  START_DATE  END_DATE    RENT_TYPE
669 25  2022-09-29  2022-10-28  장기 대여
668 13  2022-09-28  2022-09-28  단기 대여
667 10  2022-09-28  2022-10-12  단기 대여
665 23  2022-09-26  2022-10-06  단기 대여
664 19  2022-09-26  2022-10-03  단기 대여
663 15  2022-09-26  2022-09-26  단기 대여
660 27  2022-09-25  2022-12-24  장기 대여
659 25  2022-09-25  2022-09-27  단기 대여
658 21  2022-09-25  2022-09-26  단기 대여
657 11  2022-09-25  2023-01-03  장기 대여
656 10  2022-09-25  2022-09-25  단기 대여
654 12  2022-09-24  2022-09-25  단기 대여
653 6   2022-09-24  2022-10-24  장기 대여
650 13  2022-09-23  2022-09-24  단기 대여
649 7   2022-09-23  2022-10-06  단기 대여
648 5   2022-09-23  2022-11-02  장기 대여
646 23  2022-09-22  2022-09-24  단기 대여
645 10  2022-09-22  2022-09-23  단기 대여
642 19  2022-09-21  2022-09-23  단기 대여
641 12  2022-09-21  2022-09-23  단기 대여
640 8   2022-09-21  2022-09-24  단기 대여
639 25  2022-09-20  2022-09-21  단기 대여
638 15  2022-09-20  2022-09-23  단기 대여
637 11  2022-09-19  2022-09-19  단기 대여
635 24  2022-09-18  2022-10-28  장기 대여
634 19  2022-09-18  2022-09-20  단기 대여
632 11  2022-09-17  2022-09-18  단기 대여
631 8   2022-09-17  2022-09-19  단기 대여
630 20  2022-09-16  2022-10-16  장기 대여
629 18  2022-09-16  2022-10-16  장기 대여
628 12  2022-09-16  2022-09-18  단기 대여
627 8   2022-09-16  2022-09-16  단기 대여
626 23  2022-09-15  2022-09-16  단기 대여
624 24  2022-09-14  2022-09-14  단기 대여
623 20  2022-09-14  2022-09-15  단기 대여
622 13  2022-09-14  2022-09-21  단기 대여
621 11  2022-09-14  2022-09-16  단기 대여
620 28  2022-09-13  2022-12-22  장기 대여
619 18  2022-09-13  2022-09-15  단기 대여
618 8   2022-09-13  2022-09-14  단기 대여
616 25  2022-09-12  2022-09-14  단기 대여
615 11  2022-09-12  2022-09-13  단기 대여
614 28  2022-09-11  2022-09-12  단기 대여
613 4   2022-09-11  2022-10-21  장기 대여
611 13  2022-09-10  2022-09-11  단기 대여
610 20  2022-09-09  2022-09-12  단기 대여
609 18  2022-09-09  2022-09-12  단기 대여
607 24  2022-09-08  2022-09-11  단기 대여
606 22  2022-09-07  2022-12-06  장기 대여
605 25  2022-09-06  2022-09-09  단기 대여
604 22  2022-09-06  2022-09-06  단기 대여
603 18  2022-09-06  2022-09-07  단기 대여
602 20  2022-09-05  2022-09-06  단기 대여
601 2   2022-09-05  2022-10-05  장기 대여
597 23  2022-09-04  2022-09-07  단기 대여
596 11  2022-09-04  2022-09-04  단기 대여
595 10  2022-09-03  2022-09-18  단기 대여
594 12  2022-09-02  2022-09-15  단기 대여
593 25  2022-09-01  2022-09-03  단기 대여
592 10  2022-09-01  2022-09-02  단기 대여
591 8   2022-09-01  2022-09-11  단기 대여
*/